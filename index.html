<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ViralScope - DEBUG MODE</title>
    <style>
        /* CSS Sederhana untuk Fokus Fungsi */
        :root { --primary: #ff0050; --bg: #0f0f0f; --text: #fff; }
        body { font-family: sans-serif; background: var(--bg); color: var(--text); text-align: center; padding: 20px; }
        input { padding: 15px; width: 60%; border-radius: 30px; border: 2px solid #333; background: #222; color: white; font-size: 16px; }
        button { padding: 15px 30px; border-radius: 30px; border: none; background: var(--primary); color: white; font-weight: bold; cursor: pointer; margin-left: 10px; }
        #status { margin-top: 20px; padding: 15px; border-radius: 10px; display: inline-block; max-width: 80%; word-wrap: break-word; }
        .loading { color: #00f2ea; }
        .error { color: #ff4444; border: 1px solid #ff4444; background: rgba(255,68,68,0.1); }
        .success { color: #00ff00; border: 1px solid #00ff00; background: rgba(0,255,0,0.1); }
        .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 15px; margin-top: 30px; }
        .card { background: #222; padding: 10px; border-radius: 10px; text-align: left; }
        .card img { width: 100%; border-radius: 5px; }
        .card h4 { font-size: 14px; margin: 10px 0 5px; }
        .card p { font-size: 12px; color: #aaa; margin: 0; }
    </style>
</head>
<body>

    <h1>üîç ViralScope DEBUG</h1>
    <p>Jika berhasil, video YouTube asli akan muncul di bawah.</p>

    <div>
        <input type="text" id="searchInput" placeholder="Ketik: Cats, AI, Music..." value="Cats">
        <button onclick="runSearch()">SEARCH</button>
    </div>

    <div id="status">Menunggu perintah...</div>
    <div id="results" class="grid"></div>

    <script>
        // ‚ö†Ô∏è PENTING: GANTI TEKS DI BAWAH INI DENGAN API KEY ASLI KAMU
        // Jangan biarkan ada spasi di awal atau akhir kutip!
        const API_KEY = 'AIzaSyBGH3y7ZJwEtETVd1hQmwzBlZFmsvKBUJE'; 

        async function runSearch() {
            const query = document.getElementById('searchInput').value;
            const statusDiv = document.getElementById('status');
            const resultsDiv = document.getElementById('results');
            
            resultsDiv.innerHTML = ''; // Bersihkan hasil lama
            
            // 1. CEK API KEY DULU
            if (!API_KEY || API_KEY === '' || API_KEY === 'GANTI_DENGAN_API_KEY_ASLI_DISINI' || API_KEY.length < 20) {
                statusDiv.innerHTML = '‚ùå <b>ERROR FATAL:</b> API Key tidak valid atau belum diganti di kode!<br>Silakan edit file HTML dan paste kunci AIza... Anda.';
                statusDiv.className = 'error';
                console.error('DEBUG: API Key is missing or invalid. Current value length:', API_KEY ? API_KEY.length : 0);
                return;
            }

            statusDiv.innerHTML = '‚è≥ Sedang menghubungi YouTube API...';
            statusDiv.className = 'loading';
            console.log('DEBUG: Starting search for:', query);
            console.log('DEBUG: Using API Key start with:', API_KEY.substring(0, 10) + '...');

            try {
                const url = `https://www.googleapis.com/youtube/v3/search?part=snippet&maxResults=6&q=${encodeURIComponent(query)}&type=video&order=viewCount&key=${API_KEY}`;
                
                console.log('DEBUG: Fetching URL:', url);
                
                const response = await fetch(url);
                const data = await response.json();

                console.log('DEBUG: Response received:', data);

                if (response.status === 403) {
                    throw new Error(`Akses Ditolak (403). Pesan: ${data.error ? data.error.message : 'Unknown'}. Cek apakah YouTube Data API sudah di-ENABLE.`);
                }
                if (response.status === 400) {
                    throw new Error(`Permintaan Salah (400). Pesan: ${data.error ? data.error.message : 'Unknown'}. Cek format API Key.`);
                }
                if (data.error) {
                    throw new Error(data.error.message);
                }

                if (!data.items || data.items.length === 0) {
                    statusDiv.innerHTML = '‚ö†Ô∏è Tidak ada video ditemukan untuk kata kunci ini.';
                    statusDiv.className = 'error';
                    return;
                }

                // SUKSES! Tampilkan Hasil
                statusDiv.innerHTML = `‚úÖ Berhasil! Menemukan ${data.items.length} video.`;
                statusDiv.className = 'success';

                data.items.forEach(item => {
                    const videoId = item.id.videoId;
                    const title = item.snippet.title;
                    const channel = item.snippet.channelTitle;
                    const thumb = item.snippet.thumbnails.medium.url;

                    const card = document.createElement('div');
                    card.className = 'card';
                    card.innerHTML = `
                        <img src="${thumb}" alt="thumb">
                        <h4>${title}</h4>
                        <p>${channel}</p>
                        <a href="https://www.youtube.com/watch?v=${videoId}" target="_blank" style="color:#00f2ea; font-size:12px;">Tonton Video</a>
                    `;
                    resultsDiv.appendChild(card);
                });

            } catch (err) {
                statusDiv.innerHTML = `‚ùå <b>ERROR:</b> ${err.message}`;
                statusDiv.className = 'error';
                console.error('DEBUG ERROR DETAILS:', err);
            }
        }
    </script>
</body>
</html>
